<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Noruto è¿›åŒ–æ•°æ®è°ƒè¯•</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            min-height: 100vh;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 20px;
            border: 1px solid rgba(162, 155, 254, 0.3);
        }
        
        .debug-section {
            margin-bottom: 30px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .debug-section h3 {
            margin-top: 0;
            color: #4facfe;
            border-bottom: 2px solid #4facfe;
            padding-bottom: 10px;
        }
        
        .btn {
            background: linear-gradient(45deg, #4facfe, #00f2fe);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
            font-weight: bold;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(79, 172, 254, 0.4);
        }
        
        .output {
            background: rgba(0, 0, 0, 0.3);
            padding: 15px;
            border-radius: 5px;
            font-family: monospace;
            font-size: 12px;
            max-height: 400px;
            overflow-y: auto;
            white-space: pre-wrap;
            margin-top: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .success { color: #4caf50; }
        .error { color: #f44336; }
        .warning { color: #ff9800; }
        .info { color: #2196f3; }
        
        .data-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .data-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            padding: 15px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .data-card h4 {
            color: #00f2fe;
            margin-top: 0;
        }
        
        .material-item {
            background: rgba(255, 255, 255, 0.05);
            padding: 8px;
            margin: 5px 0;
            border-radius: 5px;
            border-left: 3px solid #4facfe;
        }
        
        .evolution-step {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .evolution-step h5 {
            color: #4facfe;
            margin-top: 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” Noruto è¿›åŒ–æ•°æ®è°ƒè¯•é¡µé¢</h1>
        
        <div class="debug-section">
            <h3>ğŸ§ª è°ƒè¯•æµ‹è¯•</h3>
            <button class="btn" onclick="testNorutoData()">æµ‹è¯•Norutoæ•°æ®</button>
            <button class="btn" onclick="testIdMatching()">æµ‹è¯•IDåŒ¹é…</button>
            <button class="btn" onclick="testEvolutionData()">æµ‹è¯•è¿›åŒ–æ•°æ®</button>
            <button class="btn" onclick="clearOutput()">æ¸…é™¤è¾“å‡º</button>
        </div>
        
        <div class="debug-section">
            <h3>ğŸ“Š è°ƒè¯•ç»“æœ</h3>
            <div id="debugOutput" class="output">
                ç‚¹å‡»æµ‹è¯•æŒ‰é’®å¼€å§‹è°ƒè¯•...
            </div>
        </div>
        
        <div class="debug-section">
            <h3>ğŸ—ï¸ æ¨¡æ‹Ÿè¿›åŒ–ç³»ç»Ÿ</h3>
            <div id="evolutionDisplay" class="data-grid">
                <div class="data-card">
                    <h4>Evolution Requirements</h4>
                    <div id="evolution-requirements">
                        <p>ç­‰å¾…æµ‹è¯•æ•°æ®...</p>
                    </div>
                </div>
                
                <div class="data-card">
                    <h4>Cost Summary</h4>
                    <div id="cost-summary">
                        <p>ç­‰å¾…æµ‹è¯•æ•°æ®...</p>
                    </div>
                </div>
                
                <div class="data-card">
                    <h4>Evolution Materials</h4>
                    <div id="evolution-materials">
                        <p>ç­‰å¾…æµ‹è¯•æ•°æ®...</p>
                    </div>
                </div>
                
                <div class="data-card">
                    <h4>Farming Guide</h4>
                    <div id="farming-guide">
                        <p>ç­‰å¾…æµ‹è¯•æ•°æ®...</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // æ¨¡æ‹Ÿæ•°æ®
        const mockEvolutionData = {
            "noruto": {
                unitId: "noruto",
                name: "Noruto",
                rarity: "Mythic",
                element: "Wind",
                evolutions: [
                    {
                        tier: 1,
                        name: "Noruto",
                        statMultiplier: 1.0,
                        requirements: {
                            level: 1,
                            cost: 0,
                            gems: 0,
                            materials: []
                        }
                    },
                    {
                        tier: 2,
                        name: "Noruto (Six Tails)",
                        statMultiplier: 1.5,
                        requirements: {
                            level: 50,
                            cost: 5000,
                            gems: 0,
                            materials: [
                                "Flame Heart x4",
                                "Hashira Spirit x1",
                                "Unyielding Will x1"
                            ]
                        }
                    },
                    {
                        tier: 3,
                        name: "Noruto (Nine Tails)",
                        statMultiplier: 2.0,
                        requirements: {
                            level: 100,
                            cost: 10000,
                            gems: 125,
                            materials: [
                                "Eternal Flame x3",
                                "Hashira Legacy x2",
                                "Father's Pride x1",
                                "Flame Pillar x5"
                            ]
                        }
                    }
                ]
            }
        };

        const mockUnitsData = [
            {
                id: "noruto_base",
                name: "Noruto",
                rarity: "Mythic",
                element: "Wind",
                canEvolve: true
            }
        ];

        // æ¨¡æ‹Ÿæ–¹æ³•
        function generateUnitId(unitName) {
            let id = unitName.toLowerCase().replace(/\s+/g, '');
            id = id.replace(/\([^)]*\)/g, '');
            id = id.replace(/\s+/g, '');
            return id;
        }

        function lookupEvolutionData(unitId, unit) {
            console.log(`ğŸ” Looking up evolution data for: ${unit.name} (ID: ${unitId})`);
            
            const possibleIds = [
                unitId,
                unit.id,
                unit.id.replace(/_base$/, ''),
                unit.id.replace(/_evolved$/, ''),
                generateUnitId(unit.name),
                unit.name.toLowerCase().replace(/\s+/g, '')
            ];
            
            let evolutionInfo = null;
            let matchedId = null;
            
            for (const id of possibleIds) {
                if (mockEvolutionData[id]) {
                    evolutionInfo = mockEvolutionData[id];
                    matchedId = id;
                    break;
                }
            }
            
            if (evolutionInfo) {
                console.log(`âœ… Found evolution data for ${unit.name} with ID: ${matchedId}`);
                return {
                    ...unit,
                    unitId: matchedId,
                    evolutionData: evolutionInfo,
                    evolutions: evolutionInfo.evolutions,
                    hasEvolutionData: true
                };
            }

            if (['Rare', 'Epic', 'Legendary', 'Mythic'].includes(unit.rarity)) {
                console.log(`âš ï¸ Unit ${unit.name} can evolve but no specific data found`);
                return {
                    ...unit,
                    unitId: unitId,
                    hasEvolutionData: false,
                    canEvolveByRarity: true
                };
            }

            console.log(`âŒ No evolution data found for ${unit.name}`);
            return null;
        }

        // æµ‹è¯•Norutoæ•°æ®
        window.testNorutoData = function() {
            const output = document.getElementById('debugOutput');
            output.innerHTML = 'ğŸ§ª å¼€å§‹æµ‹è¯•Norutoæ•°æ®...\n\n';
            
            const unit = mockUnitsData[0];
            const unitId = generateUnitId(unit.name);
            
            output.innerHTML += `<span class="info">ğŸ“‹ å•ä½ä¿¡æ¯:</span>\n`;
            output.innerHTML += `  - åç§°: ${unit.name}\n`;
            output.innerHTML += `  - ID: ${unit.id}\n`;
            output.innerHTML += `  - ç¨€æœ‰åº¦: ${unit.rarity}\n`;
            output.innerHTML += `  - å…ƒç´ : ${unit.element}\n`;
            output.innerHTML += `  - ç”ŸæˆID: ${unitId}\n\n`;
            
            output.innerHTML += `<span class="info">ğŸ” è¿›åŒ–æ•°æ®æŸ¥æ‰¾:</span>\n`;
            const evolutionInfo = lookupEvolutionData(unitId, unit);
            
            if (evolutionInfo) {
                output.innerHTML += `<span class="success">âœ… æ‰¾åˆ°è¿›åŒ–æ•°æ®!</span>\n`;
                output.innerHTML += `  - Unit ID: ${evolutionInfo.unitId}\n`;
                output.innerHTML += `  - Has Evolution Data: ${evolutionInfo.hasEvolutionData}\n`;
                output.innerHTML += `  - Evolution Count: ${evolutionInfo.evolutions ? evolutionInfo.evolutions.length : 0}\n\n`;
                
                // æ›´æ–°æ˜¾ç¤º
                updateEvolutionDisplay(evolutionInfo);
            } else {
                output.innerHTML += `<span class="error">âŒ æœªæ‰¾åˆ°è¿›åŒ–æ•°æ®</span>\n\n`;
            }
        };

        // æµ‹è¯•IDåŒ¹é…
        window.testIdMatching = function() {
            const output = document.getElementById('debugOutput');
            output.innerHTML = 'ğŸ” å¼€å§‹æµ‹è¯•IDåŒ¹é…...\n\n';
            
            const unit = mockUnitsData[0];
            const unitId = generateUnitId(unit.name);
            
            output.innerHTML += `<span class="info">ğŸ”‘ IDåŒ¹é…æµ‹è¯•:</span>\n`;
            
            const possibleIds = [
                unitId,
                unit.id,
                unit.id.replace(/_base$/, ''),
                unit.id.replace(/_evolved$/, ''),
                generateUnitId(unit.name),
                unit.name.toLowerCase().replace(/\s+/g, '')
            ];
            
            possibleIds.forEach((id, index) => {
                const hasData = mockEvolutionData[id] !== undefined;
                const status = hasData ? 'âœ…' : 'âŒ';
                const color = hasData ? 'success' : 'error';
                
                output.innerHTML += `  ${status} é€‰æ‹©å™¨ ${index + 1}: ${id}\n`;
                if (hasData) {
                    output.innerHTML += `    <span class="${color}">æ‰¾åˆ°æ•°æ®!</span>\n`;
                }
            });
            
            output.innerHTML += '\n';
        };

        // æµ‹è¯•è¿›åŒ–æ•°æ®
        window.testEvolutionData = function() {
            const output = document.getElementById('debugOutput');
            output.innerHTML = 'ğŸ“Š å¼€å§‹æµ‹è¯•è¿›åŒ–æ•°æ®...\n\n';
            
            const norutoData = mockEvolutionData.noruto;
            
            if (norutoData) {
                output.innerHTML += `<span class="success">âœ… Norutoè¿›åŒ–æ•°æ®:</span>\n`;
                output.innerHTML += `  - åç§°: ${norutoData.name}\n`;
                output.innerHTML += `  - ç¨€æœ‰åº¦: ${norutoData.rarity}\n`;
                output.innerHTML += `  - å…ƒç´ : ${norutoData.element}\n`;
                output.innerHTML += `  - è¿›åŒ–é˜¶æ®µ: ${norutoData.evolutions.length}\n\n`;
                
                norutoData.evolutions.forEach((evo, index) => {
                    output.innerHTML += `<span class="info">é˜¶æ®µ ${index + 1}: ${evo.name}</span>\n`;
                    output.innerHTML += `  - å±æ€§å€æ•°: ${evo.statMultiplier}x\n`;
                    output.innerHTML += `  - ç­‰çº§è¦æ±‚: ${evo.requirements.level}\n`;
                    output.innerHTML += `  - é‡‘å¸æˆæœ¬: ${evo.requirements.cost.toLocaleString()}\n`;
                    if (evo.requirements.gems > 0) {
                        output.innerHTML += `  - å®çŸ³æˆæœ¬: ${evo.requirements.gems}\n`;
                    }
                    if (evo.requirements.materials.length > 0) {
                        output.innerHTML += `  - ææ–™: ${evo.requirements.materials.join(', ')}\n`;
                    }
                    output.innerHTML += '\n';
                });
            } else {
                output.innerHTML += `<span class="error">âŒ æœªæ‰¾åˆ°Norutoè¿›åŒ–æ•°æ®</span>\n`;
            }
        };

        // æ›´æ–°è¿›åŒ–æ˜¾ç¤º
        function updateEvolutionDisplay(evolutionInfo) {
            if (!evolutionInfo.hasEvolutionData) {
                document.getElementById('evolution-requirements').innerHTML = '<p>æ— è¿›åŒ–æ•°æ®</p>';
                return;
            }

            // Evolution Requirements
            const evoHtml = `
                <div class="evolution-requirements">
                    <h5>è¿›åŒ–è·¯å¾„</h5>
                    ${evolutionInfo.evolutions.map((evo, index) => `
                        <div class="evolution-step">
                            <h5>${evo.name}</h5>
                            <p>å±æ€§å€æ•°: ${evo.statMultiplier}x</p>
                            <p>ç­‰çº§è¦æ±‚: ${evo.requirements.level}</p>
                            <p>é‡‘å¸æˆæœ¬: ${evo.requirements.cost.toLocaleString()}</p>
                            ${evo.requirements.gems > 0 ? `<p>å®çŸ³æˆæœ¬: ${evo.requirements.gems}</p>` : ''}
                        </div>
                    `).join('')}
                </div>
            `;
            document.getElementById('evolution-requirements').innerHTML = evoHtml;

            // Cost Summary
            const totalCost = evolutionInfo.evolutions.reduce((sum, evo) => sum + evo.requirements.cost, 0);
            const totalGems = evolutionInfo.evolutions.reduce((sum, evo) => sum + evo.requirements.gems, 0);
            const totalMaterials = evolutionInfo.evolutions.reduce((sum, evo) => sum + evo.requirements.materials.length, 0);
            
            const costHtml = `
                <div class="cost-summary">
                    <h5>æ€»æˆæœ¬</h5>
                    <p>é‡‘å¸: ${totalCost.toLocaleString()}</p>
                    <p>å®çŸ³: ${totalGems}</p>
                    <p>ææ–™: ${totalMaterials}</p>
                </div>
            `;
            document.getElementById('cost-summary').innerHTML = costHtml;

            // Materials
            const allMaterials = new Map();
            evolutionInfo.evolutions.forEach(evo => {
                evo.requirements.materials.forEach(material => {
                    const [name, quantity] = material.split(' x');
                    const existing = allMaterials.get(name) || 0;
                    allMaterials.set(name, existing + parseInt(quantity || 1));
                });
            });

            const materialsHtml = `
                <div class="materials-list">
                    <h5>æ‰€éœ€ææ–™</h5>
                    ${Array.from(allMaterials.entries()).map(([name, quantity]) => `
                        <div class="material-item">
                            ${name} x${quantity}
                        </div>
                    `).join('')}
                </div>
            `;
            document.getElementById('evolution-materials').innerHTML = materialsHtml;

            // Farming Guide
            const farmingHtml = `
                <div class="farming-guide">
                    <h5>å†œåœºæŒ‡å—</h5>
                    <p>æ¨èå†œåœºæ–¹æ³•:</p>
                    <ul>
                        <li>æ¯æ—¥ææ–™åœ°ä¸‹åŸ</li>
                        <li>æ¯å‘¨BossæŒ‘æˆ˜</li>
                        <li>æœˆåº¦ä¼ å¥‡äº‹ä»¶</li>
                    </ul>
                </div>
            `;
            document.getElementById('farming-guide').innerHTML = farmingHtml;
        }

        // æ¸…é™¤è¾“å‡º
        window.clearOutput = function() {
            document.getElementById('debugOutput').innerHTML = 'ç‚¹å‡»æµ‹è¯•æŒ‰é’®å¼€å§‹è°ƒè¯•...';
            console.log('ğŸ—‘ï¸ è¾“å‡ºå·²æ¸…é™¤');
        };

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸš€ Norutoè°ƒè¯•é¡µé¢å·²åŠ è½½');
            console.log('ğŸ§ª æ¨¡æ‹Ÿæ•°æ®å·²å‡†å¤‡å°±ç»ª');
            console.log('ğŸ” å¯ä»¥å¼€å§‹æµ‹è¯•Norutoçš„è¿›åŒ–æ•°æ®');
        });
    </script>
</body>
</html>
