<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-H7C8MVNRR1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-H7C8MVNRR1');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Anime Vanguards Calculator</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- CSS Files -->
    <link rel="stylesheet" href="css/main.css">
    <link rel="stylesheet" href="css/components/header.css">
    <link rel="stylesheet" href="css/components/cards.css">
    <link rel="stylesheet" href="css/components/forms.css">
    <link rel="stylesheet" href="css/components/dropdowns.css">
    <link rel="stylesheet" href="css/pages/evolution.css">
    <link rel="stylesheet" href="css/pages/dps.css">
    <link rel="stylesheet" href="css/pages/database.css">
    <link rel="stylesheet" href="css/responsive.css">
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-calculator"></i> Anime Vanguards Calculator</h1>
            <p>Evolution Materials & DPS Calculator</p>
        </div>

        <!-- Unit Selector Component -->
        <div id="unitSelectorContainer"></div>

        <!-- Materials List Component -->
        <div id="materialsListContainer"></div>

        <!-- Cost Summary Component -->
        <div id="costSummaryContainer"></div>

        <!-- Farming Guide Component -->
        <div id="farmingGuideContainer"></div>
    </div>

    <script type="module">
        // Import data modules
        import { unitsData } from './js/config/units.js';
        import { materialsConfig } from './js/config/materials.js';
        import { elementIcons } from './js/config/constants.js';
        
        // Import utility functions
        import { showError } from './js/utils/dom.js';
        import { validateUnitData, validateMaterialsConfig, validateElementIcons } from './js/utils/validation.js';
        
        // Import components
        import { UnitSelector } from './js/components/UnitSelector.js';
        import { MaterialsList } from './js/components/MaterialsList.js';
        import { CostSummary } from './js/components/CostSummary.js';
        import { FarmingGuide } from './js/components/FarmingGuide.js';

        console.log('‚úÖ Data modules loaded successfully!');
        console.log('üìä Units:', Object.keys(unitsData).length);
        console.log('üîß Materials:', Object.keys(materialsConfig).length);
        console.log('üé® Elements:', Object.keys(elementIcons).length);

        // Component instances
        let unitSelector;
        let materialsList;
        let costSummary;
        let farmingGuide;

        // Initialize
        function init() {
            console.log('üöÄ Initializing application...');
            
            // Validate data
            const unitValidation = validateUnitData(unitsData);
            const materialValidation = validateMaterialsConfig(materialsConfig);
            const iconValidation = validateElementIcons(elementIcons);
            
            if (!unitValidation.isValid) {
                console.error('‚ùå Unit data validation failed:', unitValidation.errors);
                showError('Unit data validation failed', 'error');
            }
            
            if (!materialValidation.isValid) {
                console.error('‚ùå Materials validation failed:', materialValidation.errors);
                showError('Materials validation failed', 'error');
            }
            
            if (!iconValidation.isValid) {
                console.error('‚ùå Element icons validation failed:', iconValidation.errors);
                showError('Element icons validation failed', 'error');
            }
            
            // Initialize components
            initializeComponents();
            
            console.log('‚úÖ Application initialized!');
        }

        // Initialize all components
        function initializeComponents() {
            // Initialize Unit Selector
            unitSelector = new UnitSelector('unitSelectorContainer', {
                onUnitSelect: handleUnitSelect,
                showFilters: true,
                showSearch: true,
                debounceDelay: 300
            });
            
            // Initialize Materials List
            materialsList = new MaterialsList('materialsListContainer', {
                showRarity: true,
                showDescription: true,
                showQuantity: true
            });
            
            // Initialize Cost Summary
            costSummary = new CostSummary('costSummaryContainer', {
                showBreakdown: true,
                showTotal: true,
                currency: 'Gold'
            });
            
            // Initialize Farming Guide
            farmingGuide = new FarmingGuide('farmingGuideContainer', {
                showPriority: true,
                showDifficulty: true,
                showTips: true,
                showObtainMethods: true
            });
            
            // Set up component data
            unitSelector.setUnits(unitsData, elementIcons);
            materialsList.setMaterialsConfig(materialsConfig);
            costSummary.setMaterialsConfig(materialsConfig);
        }

        // Handle unit selection
        function handleUnitSelect(unit) {
            console.log('Unit selected:', unit.name);
            
            // Update all components with the selected unit
            materialsList.updateMaterials(unit);
            costSummary.updateCost(unit);
            farmingGuide.updateGuide(unit);
        }

        // Initialize when DOM is loaded
        document.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html> 